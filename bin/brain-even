#!/usr/bin/env php
<?php

require_once 'vendor/autoload.php';

use function BrainGames\Cli\welcomeUser;
use function cli\line;
use function cli\prompt;

function greetUser()
{
    line('Welcome to the Brain Game!');
    $name = prompt('May I have your name?');
    line("Hello, %s!", $name);
    line('Answer "yes" if the number is even, otherwise answer "no"');
    return $name;
}

function generateRandomNumber()
{
    return random_int(1, 99);
}

function isAnswerCorrect($answer, $randomNumber)
{
    return ($randomNumber % 2 === 0 and $answer === "yes") ||
        ($randomNumber % 2 !== 0 and $answer === "no");
}

function askQuestion()
{
    $randomNumber = generateRandomNumber();
    line("Question: $randomNumber");
    $answer = prompt('Your answer');
    return isAnswerCorrect($answer, $randomNumber);
}

function playGame($name)
{
    $i = 0;
    while ($i < 3) {
        if (askQuestion()) {
            $i = $i + 1;
            line("correct!");
        } else {
            return false;
        }
    }
    return true;
}

function announceResult($name)
{
    if (playGame($name)) {
        line("Congratulations, $name!");
    } else {
        line("Let's try again, $name!");
    }
}

function startGame()
{
    $name = greetUser();
    announceResult($name);
}

startGame();